{% extends "base.html" %}
{% block content %}
  <h2 class="text-center mb-3">Latest {{ topic.title() }} News</h2>

  <!-- Topic badges as links -->
  <div class="d-flex justify-content-center flex-wrap mb-4">
    {% set topics = ['business','technology','sports','health','science','entertainment'] %}
    {% for t in topics %}
      <a href="{{ url_for('index', topic=t) }}"
         class="badge rounded-pill topic-badge m-1 {% if topic == t %}active{% else %}bg-primary{% endif %}">
        {{ t.title() }}
      </a>
    {% endfor %}
  </div>

  <!-- Articles Grid -->
  <div id="articles" class="row">
    {% for article in articles %}
      <div class="col-12 col-md-6 mb-4">
        <div class="card article-card h-100 shadow-sm">
          {% if article.image_url %}
            <img src="{{ article.image_url }}"
                 class="article-img"
                 alt="Article image"
                 onerror="this.onerror=null;this.src='https://via.placeholder.com/800x450?text=No+Image';">
          {% else %}
            <img src="https://via.placeholder.com/800x450?text=No+Image"
                 class="article-img"
                 alt="Article image">
          {% endif %}

          <div class="card-body d-flex flex-column">
            <h5 class="card-title">{{ article.title }}</h5>
            <p class="card-text mb-3">{{ article.content | truncate(180) }}</p>

            <div class="mt-auto d-flex justify-content-between align-items-center">
              <small class="text-muted">
                {{ article.timestamp | replace("T", " ") | replace("Z", "") }}
              </small>
              <a class="btn btn-sm btn-primary"
                 href="{{ article.source_url }}"
                 target="_blank" rel="noopener noreferrer">
                Read More
              </a>
            </div>

            <div class="mt-2">
              <span class="badge bg-secondary badge-source">Source: {{ article.source }}</span>
            </div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  {% if articles|length == 0 %}
    <div class="alert alert-info">No articles available at the moment.</div>
  {% endif %}

  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center mt-3">
      <li class="page-item {% if page <= 1 %}disabled{% endif %}">
        <a class="page-link"
           href="{{ url_for('index', page=page-1, topic=topic) if page > 1 else '#' }}"
           aria-label="Previous">
          <i class="fas fa-arrow-left"></i>
        </a>
      </li>
      <li class="page-item disabled">
        <span class="page-link">Page {{ page }} of {{ total_pages }}</span>
      </li>
      <li class="page-item {% if page >= total_pages %}disabled{% endif %}">
        <a class="page-link"
           href="{{ url_for('index', page=page+1, topic=topic) if page < total_pages else '#' }}"
           aria-label="Next">
          <i class="fas fa-arrow-right"></i>
        </a>
      </li>
    </ul>
  </nav>
{% endblock %}
